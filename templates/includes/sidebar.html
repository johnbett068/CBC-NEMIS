<!-- sidebar.html -->
<div class="h-full flex flex-col py-6 px-4 bg-gray-100">

    <!-- User Info -->
    {% if user.is_authenticated %}
    <div class="mb-6 px-2">
        <p class="text-gray-700 font-semibold">Hello, {{ user.get_full_name }}</p>
        <p class="text-sm text-gray-500 capitalize">{{ user.role|default:"User" }}</p>
    </div>
    {% endif %}

    <!-- Navigation -->
    <nav class="flex-1 overflow-y-auto">
        <ul class="space-y-2">

            <!-- Home -->
            <li>
                <a href="{% url 'home:home' %}" class="flex items-center p-2 text-gray-700 rounded hover:bg-blue-200 hover:text-blue-800">
                    <i class="fas fa-home w-5"></i>
                    <span class="ml-2 label-text">Home</span>
                </a>
            </li>

            <!-- Schools -->
            {% if user.role in ['cabinet_secretary', 'county_director', 'subcounty_director', 'school_admin'] %}
            <li>
                <a href="{% url 'schools:school_list' %}" class="flex items-center p-2 text-gray-700 rounded hover:bg-blue-200 hover:text-blue-800">
                    <i class="fas fa-school w-5"></i>
                    <span class="ml-2 label-text">Schools</span>
                </a>
            </li>
            {% endif %}

            <!-- Teachers (Collapsible) -->
            {% if user.role in ['cabinet_secretary', 'county_director', 'subcounty_director', 'school_admin', 'teacher'] %}
            <li x-data="{ open: false }">
                <button @click="open = !open"
                        class="flex items-center justify-between w-full p-2 text-gray-700 rounded hover:bg-blue-200 hover:text-blue-800 focus:outline-none">
                    <span class="flex items-center">
                        <i class="fas fa-chalkboard-teacher w-5"></i>
                        <span class="ml-2 label-text">Teachers</span>
                    </span>
                    <i :class="{'fa-chevron-down': !open, 'fa-chevron-up': open}" class="fas w-4 transition-transform"></i>
                </button>
                <ul x-show="open" class="pl-8 mt-2 space-y-1 text-gray-600" x-cloak>
                    <li>
                        <a href="{% url 'teachers:teacher_list' %}" class="block p-1 rounded hover:bg-blue-100">All Teachers</a>
                    </li>
                    {% if user.role in ['cabinet_secretary', 'school_admin'] %}
                    <li>
                        <a href="{% url 'teachers:teacher_add' %}" class="block p-1 rounded hover:bg-blue-100">Add Teacher</a>
                    </li>
                    <li>
                        <a href="{% url 'teachers:subject_assignment_list' %}" class="block p-1 rounded hover:bg-blue-100">Subject Assignments</a>
                    </li>
                    <li>
                        <a href="{% url 'teachers:class_assignment_add' %}" class="block p-1 rounded hover:bg-blue-100">Class Assignments</a>
                    </li>
                    {% endif %}
                </ul>
            </li>
            {% endif %}

            <!-- Learners (Collapsible) -->
            {% if user.role in ['cabinet_secretary', 'county_director', 'subcounty_director', 'school_admin', 'teacher'] %}
            <li x-data="{ open: false }">
                <button @click="open = !open"
                        class="flex items-center justify-between w-full p-2 text-gray-700 rounded hover:bg-blue-200 hover:text-blue-800 focus:outline-none">
                    <span class="flex items-center">
                        <i class="fas fa-user-graduate w-5"></i>
                        <span class="ml-2 label-text">Learners</span>
                    </span>
                    <i :class="{'fa-chevron-down': !open, 'fa-chevron-up': open}" class="fas w-4 transition-transform"></i>
                </button>
                <ul x-show="open" class="pl-8 mt-2 space-y-1 text-gray-600" x-cloak>
                    <li>
                        <a href="{% url 'learners:learner_list' %}" class="block p-1 rounded hover:bg-blue-100">All Learners</a>
                    </li>
                    {% if user.role in ['cabinet_secretary', 'school_admin'] %}
                    <li>
                        <a href="{% url 'learners:add_learner' %}" class="block p-1 rounded hover:bg-blue-100">Add Learner</a>
                    </li>
                    {% endif %}
                    <li>
                        <a href="#" class="block p-1 rounded hover:bg-blue-100">Edit Learner</a>
                    </li>
                </ul>
            </li>
            {% endif %}

            <!-- Subjects -->
            {% if user.role in ['cabinet_secretary', 'county_director', 'subcounty_director', 'school_admin', 'teacher'] %}
            <li>
                <a href="{% url 'subjects:subject_list' %}" class="flex items-center p-2 text-gray-700 rounded hover:bg-blue-200 hover:text-blue-800">
                    <i class="fas fa-book w-5"></i>
                    <span class="ml-2 label-text">Subjects</span>
                </a>
            </li>
            {% endif %}

            <!-- Logout -->
            {% if user.is_authenticated %}
            <li>
                <a href="{% url 'accounts:logout' %}" class="flex items-center p-2 text-red-600 rounded hover:bg-red-100 hover:text-red-800">
                    <i class="fas fa-sign-out-alt w-5"></i>
                    <span class="ml-2 label-text">Logout</span>
                </a>
            </li>
            {% endif %}

        </ul>
    </nav>
</div>

<!-- AlpineJS for collapsible menus -->
<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
